{"version":3,"file":"Compiler.js","names":["ts","_interopRequireWildcard","require","_FormTscOptions","_LogTscDiagnostic","_TypeScriptLinter","_TSCCompiledProgram","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","compile","cmdOptions","overrideCompilerOptions","createProgramOptions","formTscOptions","program","createProgram","logTscErrors","diagnostics","getPreEmitDiagnostics","logTscDiagnostic","consoleLog","compileLintOptions","enableCheckTsFile","strict","getOverrideCompilerOptions","nonStrict","tscCompiledProgram","TSCCompiledProgramWithDiagnostics","inputFiles","isEtsFile","alwaysStrict","noImplicitAny","noImplicitThis","strictBindCallApply","useUnknownInCatchVariables","strictNullChecks","strictFunctionTypes","strictPropertyInitialization","noImplicitReturns"],"sources":["../../src/Compiler.ts"],"sourcesContent":["/*\n * Copyright (c) 2023-2024 Huawei Device Co., Ltd.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as ts from 'typescript';\nimport type { CommandLineOptions } from '../lib/CommandLineOptions';\nimport { formTscOptions } from './ts-compiler/FormTscOptions';\nimport { logTscDiagnostic } from '../lib/utils/functions/LogTscDiagnostic';\nimport { consoleLog } from '../lib/TypeScriptLinter';\nimport type { LintOptions } from '../lib/LintOptions';\nimport { TSCCompiledProgramWithDiagnostics } from '../lib/ts-diagnostics/TSCCompiledProgram';\n\nfunction compile(cmdOptions: CommandLineOptions, overrideCompilerOptions: ts.CompilerOptions): ts.Program {\n  const createProgramOptions = formTscOptions(cmdOptions, overrideCompilerOptions);\n  const program = ts.createProgram(createProgramOptions);\n  // Log Tsc errors if needed\n  if (cmdOptions.logTscErrors) {\n    const diagnostics = ts.getPreEmitDiagnostics(program);\n    logTscDiagnostic(diagnostics, consoleLog);\n  }\n  return program;\n}\n\nexport function compileLintOptions(cmdOptions: CommandLineOptions, enableCheckTsFile?: boolean): LintOptions {\n  const strict = compile(cmdOptions, getOverrideCompilerOptions(true));\n  const nonStrict = compile(cmdOptions, getOverrideCompilerOptions(false));\n  return {\n    cmdOptions: cmdOptions,\n    tscCompiledProgram: new TSCCompiledProgramWithDiagnostics(strict, nonStrict, cmdOptions.inputFiles),\n    isEtsFile: !enableCheckTsFile\n  };\n}\n\nfunction getOverrideCompilerOptions(strict: boolean): ts.CompilerOptions {\n  return {\n    strict: false,\n    alwaysStrict: false,\n    noImplicitAny: false,\n    noImplicitThis: false,\n    strictBindCallApply: false,\n    useUnknownInCatchVariables: false,\n    strictNullChecks: strict,\n    strictFunctionTypes: strict,\n    strictPropertyInitialization: strict,\n    noImplicitReturns: strict\n  };\n}\n"],"mappings":"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","ignoreList":[]}