{"version":3,"file":"ArkTSTimePrinter.js","names":["TimePhase","exports","ArkTSLinterTimePrinter","constructor","ArkTSTimePrintSwitch","_defineProperty","Map","arkTSTimePrintSwitch","getInstance","instance","destroyInstance","undefined","setArkTSTimePrintSwitch","appendTime","key","timeMap","set","Date","now","formatMapAsTable","map","_this","has","START","maxKeyLength","lastVal","sum","printMap","forEach","value","_newArrowCheck","Math","max","toString","length","relativeVal","GET_PROGRAM","bind","table","paddedKey","padEnd","header","FIXLENGTH","separator","repeat","printTimes","formattedMap","console","log","_ArkTSLinterTimePrinter"],"sources":["../../sdk/ArkTSTimePrinter.ts"],"sourcesContent":["/*\n * Copyright (c) 2024 Huawei Device Co., Ltd.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum TimePhase {\n  START = 'start',\n  GET_PROGRAM = 'getProgram(not ArkTSLinter)',\n  GET_REVERSE_STRICT_BUILDER_PROGRAM = 'getReverseStrictBuilderProgram',\n  UPDATE_ERROR_FILE = 'updateErrorFile',\n  INIT = 'init',\n  STRICT_PROGRAM_GET_SEMANTIC_DIAGNOSTICS = 'strictProgramGetSemanticDiagnostics',\n  STRICT_PROGRAM_GET_SYNTACTIC_DIAGNOSTICS = 'strictProgramGetSyntacticDiagnostics',\n  NON_STRICT_PROGRAM_GET_SEMANTIC_DIAGNOSTICS = 'nonStrictProgramGetSemanticDiagnostics',\n  NON_STRICT_PROGRAM_GET_SYNTACTIC_DIAGNOSTICS = 'nonStrictProgramGetSyntacticDiagnostics',\n  GET_TSC_DIAGNOSTICS = 'getTscDiagnostics',\n  EMIT_BUILD_INFO = 'emitBuildInfo',\n  LINT = 'lint'\n}\n\nexport class ArkTSLinterTimePrinter {\n  private static instance?: ArkTSLinterTimePrinter;\n  private arkTSTimePrintSwitch: boolean;\n  private readonly timeMap = new Map<string, number>();\n\n  private constructor(ArkTSTimePrintSwitch: boolean = false) {\n    this.arkTSTimePrintSwitch = ArkTSTimePrintSwitch;\n  }\n\n  static getInstance(): ArkTSLinterTimePrinter {\n    if (!ArkTSLinterTimePrinter.instance) {\n      ArkTSLinterTimePrinter.instance = new ArkTSLinterTimePrinter();\n    }\n    return ArkTSLinterTimePrinter.instance;\n  }\n\n  static destroyInstance(): void {\n    ArkTSLinterTimePrinter.instance = undefined;\n  }\n\n  setArkTSTimePrintSwitch(arkTSTimePrintSwitch: boolean): void {\n    this.arkTSTimePrintSwitch = arkTSTimePrintSwitch;\n  }\n\n  appendTime(key: string): void {\n    if (this.arkTSTimePrintSwitch) {\n      this.timeMap.set(key, Date.now());\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  private formatMapAsTable(map: Map<string, number>): string {\n    if (!map.has(TimePhase.START)) {\n      return 'ArkTSLinterTimePrinter: START phase is not exist!';\n    }\n    let maxKeyLength = 0;\n    let lastVal = 0;\n    let sum = 0;\n    const printMap = new Map(map);\n    printMap.forEach((value, key) => {\n      maxKeyLength = Math.max(maxKeyLength, key.toString().length);\n      if (key !== TimePhase.START) {\n        const relativeVal = value - lastVal;\n        if (key !== TimePhase.GET_PROGRAM) {\n          sum += relativeVal;\n        }\n        printMap.set(key, relativeVal / 1000.0);\n      }\n      lastVal = value;\n    });\n    printMap.set('total', sum / 1000.0);\n\n    let table = '';\n    printMap.forEach((value, key) => {\n      if (key !== TimePhase.START) {\n        const paddedKey = key.toString().padEnd(maxKeyLength, ' ');\n        table += `${paddedKey} | ${value.toString()}\\n`;\n      }\n    });\n    const header = `${'Phase'.padEnd(maxKeyLength, ' ')} | Time(seconds)\\n`;\n    const FIXLENGTH = ('Phase' + 'Time').length;\n    const separator = '-'.repeat(maxKeyLength + FIXLENGTH) + '\\n';\n    return `${header}${separator}${table}`;\n  }\n\n  printTimes(): void {\n    if (this.arkTSTimePrintSwitch) {\n      const formattedMap = this.formatMapAsTable(this.timeMap);\n      console.log(formattedMap);\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}